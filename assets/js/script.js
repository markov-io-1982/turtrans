const createStore=Redux.createStore,Button=ReactBootstrap.Button,ACTION_SEAT_CLICK="SEAT_CLICK",ACTION_ORDER="ORDER",ROW_SEAT_DELIMITER="-",data={id:"2016-03-28T19:00",title:"Bus",rows:[{row:"1",seats:["1","2","3","4"]},{row:"2",seats:["5","6","7","8"]},{row:"3",seats:["9","10","11","12"]},{row:"4",seats:["13","14","15","16"]},{row:"5",seats:["17","18","19","20"]},{row:"6",seats:["21","22","23","24"]},{row:"7",seats:["25","26"]},{row:"8",seats:["27","28","29","30"]},{row:"9",seats:["31","32","33","34"]},{row:"10",seats:["35","36","37","38"]},{row:"11",seats:["39","40","41","42"]},{row:"12",seats:["43","44","45","46"]},{row:"13",seats:["47","48","49","50"]},{row:"14",seats:["51","52","53","54"]},{row:"15",seats:["55","56","57","58","59"]}],status:{1:{1:1,2:1,3:1,4:1},2:{5:1,6:1,7:1,8:1},3:{9:1,10:1,11:1,12:1},4:{13:1,14:1,15:1,16:1},5:{17:0,18:1,19:1,20:1},6:{21:1,22:1,23:1,24:1},7:{25:1,26:1},8:{27:1,28:1,29:1,30:1},9:{31:0,32:1,33:1,34:1},10:{35:1,36:1,37:1,38:1},11:{39:1,40:1,41:1,42:1},12:{43:1,44:1,45:1,46:1},13:{47:1,48:1,49:1,50:1},14:{51:1,52:1,53:1,54:1},15:{55:1,56:1,57:1,58:1,59:1}},prices:{1:900,0:"Продані"},reserved:[]};let discount=[{value:"0",text:"немає"},{value:"5",text:"Діти: від 0 до 5р 5%"},{value:"10",text:"Персіонер 10%"},{value:"15",text:"Студент 15%"},{value:"18",text:"VIP 18%"}];function cloneState(e){return JSON.parse(JSON.stringify(e))}function formatCurrency(e){return e.toLocaleString("uk-UA",{style:"currency",currency:"UAH"})}function seatClick(e,t){store.dispatch({type:ACTION_SEAT_CLICK,rowNo:e,seatNo:t})}function order(){store.dispatch({type:ACTION_ORDER})}function booking(e=data,t){switch(t.type){case ACTION_SEAT_CLICK:const a=t.rowNo+ROW_SEAT_DELIMITER+t.seatNo,s=cloneState(e);if(s.reserved){const e=s.reserved.indexOf(a);e>=0?s.reserved.splice(e,1):s.reserved.push(a)}else s.reserved=[a];return s;case ACTION_ORDER:let r=cloneState(e);return r.reserved.map(function(e){const t=e.split(ROW_SEAT_DELIMITER)[0],a=e.split(ROW_SEAT_DELIMITER)[1];r.status[t][a]=-r.status[t][a]}),r.reserved=[],r;default:return e}}class Seat extends React.Component{render(){const e=this.props.rowNo,t=this.props.seatNo,a=t?this.props.status:0,s=e+ROW_SEAT_DELIMITER+t,r=store.getState().reserved.indexOf(s)>=0,c=0==a||"r"==t?"":r?"reserved":a<0?"booked":"free";return React.createElement("div",{className:"seat seat-category-"+("r"==t?"r":a)+(c?" seat-status-"+c:""),onClick:a<=0?"":function(){seatClick(e,t)}},"r"==t?e:t||"-")}}class Row extends React.Component{render(){const e=this.props.rowNo,t=this.props.seats,a=this.props.status;return React.createElement("div",null,t.map(function(t,s){return React.createElement(Seat,{rowNo:e,seatNo:t,status:a[t],key:s})}))}}class Stage extends React.Component{render(){const e=this.props.firstRow;let t=e.length,a=0;for(;a<e.length&&(""==e[a]||"r"==e[a]);)t--,a++;for(a=e.length-1;a>=0&&(""==e[a]||"r"==e[a]);)t--,a--;return React.createElement("div",{className:"stage none-element",style:{width:24*t}},"BUS")}}class Theatre extends React.Component{render(){const e=this.props.rows,t=this.props.status;return React.createElement("div",{className:"theatre"},React.createElement(Stage,{firstRow:e[0].seats}),e.map(function(e,a){const s=e.row;return React.createElement(Row,{rowNo:s,seats:e.seats,status:t[s],key:a})}))}}class ReservedOneSeat extends React.Component{constructor(e){super(e),this.state={value:"0"},this.handleChange=this.handleChange.bind(this)}handleChange(e){this.setState({value:e.target.value})}render(){const e=this.props.rowNo,t=this.props.seatNo,a=0==this.state.value?formatCurrency(this.props.price):formatCurrency(this.props.price-this.props.price*this.state.value/100);return React.createElement("div",{className:"reserved-seat"},React.createElement("div",{className:"row"},React.createElement("div",{className:"col-sm-12 wp-for-delete-button"},React.createElement("div",{className:"reserved-seat-category seat-category-",onClick:function(){seatClick(e,t)}},"X")),React.createElement("div",{className:"col-sm-6"},React.createElement("label",{},"І'мя"),React.createElement("input",{className:"form-control"})),React.createElement("div",{className:"col-sm-6"},React.createElement("label",{},"Прізвище"),React.createElement("input",{className:"form-control"})),React.createElement("div",{className:"col-sm-6"},React.createElement("label",{},"Phone"),React.createElement("input",{className:"form-control",type:"tel"})),React.createElement("div",{className:"col-sm-6"},React.createElement("label",{},"Email"),React.createElement("input",{className:"form-control",type:"email"})),React.createElement("div",{className:"col-sm-12"},React.createElement("label",{},"Знижка"),React.createElement("div",{className:"fl-box"},React.createElement("select",{value:this.state.value,onChange:this.handleChange,className:"form-control"},discount.map(e=>React.createElement("option",{value:e.value,key:e.value},e.text))))),React.createElement("div",{className:"col-sm-6 place-price"},React.createElement("b",null,t)," Місце "),React.createElement("div",{className:"col-sm-6 place-price"},React.createElement("label",{}," Ціна ",a))))}}class ReservedSeats extends React.Component{render(){const e=this.props.reserved;let t=0;return React.createElement("div",{className:"reserved-seats"},e.map(function(e){const a=e.split(ROW_SEAT_DELIMITER)[0],s=e.split(ROW_SEAT_DELIMITER)[1],r=store.getState().status[a][s],c=store.getState().prices[r];return t+=c,React.createElement(ReservedOneSeat,{rowNo:a,seatNo:s,category:r,price:c,key:"reserved-seat-"+e})}),React.createElement("div",{className:"row"},React.createElement("div",{className:"col-sm-12"},React.createElement("div",{className:"reserved-total"},React.createElement("span",{className:"reserved-total-label"},"Сума:"),React.createElement("span",{className:"reserved-total-price"},formatCurrency(t))))))}}class App extends React.Component{render(){return React.createElement("div",{className:"container-fluid app"},React.createElement("div",{className:"row"},React.createElement("div",{className:"col-sm-6"},React.createElement(Theatre,{rows:store.getState().rows,status:store.getState().status})),React.createElement("div",{className:"col-sm-6"},React.createElement(ReservedSeats,{reserved:store.getState().reserved}),React.createElement("div",null,React.createElement(Button,{bsStyle:"primary",onClick:()=>order()},"Оплатити")))))}}function render(){ReactDOM.render(React.createElement(App,null),document.getElementById("app"))}const store=createStore(booking);render(),store.subscribe(render);
//# sourceMappingURL=script.js.map
